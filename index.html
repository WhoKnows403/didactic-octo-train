<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Soul Mirror Analysis</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* --- ØªØ¹Ø±ÛŒÙ Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ ØªÙ… (Ø§Ø² Ø±ÙˆÛŒ Ø¹Ú©Ø³) --- */
        :root {
            --bg-color: #FDF6EC;      /* Ú©Ø±Ù… Ø±ÙˆØ´Ù† */
            --card-bg: #FFFFFF;       /* Ø³ÙÛŒØ¯ */
            --primary: #1E5F74;       /* Ø¢Ø¨ÛŒ Ù†ÙØªÛŒ (Ú©Øª Ù…Ø±Ø¯) */
            --accent: #FCD059;        /* Ø²Ø±Ø¯ (Ú©Ø±Ø§ÙˆØ§Øª) */
            --text-main: #2C3E50;     /* Ø®Ø§Ú©Ø³ØªØ±ÛŒ ØªÛŒØ±Ù‡ */
            --text-light: #95A5A6;    /* Ø®Ø§Ú©Ø³ØªØ±ÛŒ Ø±ÙˆØ´Ù† */
            --shadow: 0 10px 30px rgba(30, 95, 116, 0.1);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden; /* Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø³Ú©Ø±ÙˆÙ„ Ø§Ø¶Ø§ÙÙ‡ */
        }

        /* ØµÙØ­Ù‡ Ù„ÙˆØ¯ÛŒÙ†Ú¯ Ùˆ Ø§Ù…Ù†ÛŒØª */
        #access-denied { display: none; color: red; text-align: center; padding: 50px; }

        /* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø§ØµÙ„ÛŒ */
        .app-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            max-width: 500px;
            margin: 0 auto;
            width: 100%;
            display: none; /* Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ù…Ø®ÙÛŒ */
        }

        /* --- Ù†ÙˆØ§Ø± Ù¾ÛŒØ´Ø±ÙØª --- */
        .progress-container {
            width: 100%;
            height: 6px;
            background-color: rgba(30, 95, 116, 0.1);
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), #2a8aae);
            width: 0%;
            border-radius: 10px;
            transition: width 0.4s ease-out;
            box-shadow: 0 0 10px rgba(30, 95, 116, 0.3);
        }

        /* --- Ú©Ø§Ø±Øª Ø³ÙˆØ§Ù„ --- */
        .card {
            background: var(--card-bg);
            border-radius: 25px;
            padding: 30px 25px;
            box-shadow: var(--shadow);
            text-align: center;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .question-meta {
            font-size: 0.85rem;
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 600;
            line-height: 1.5;
            color: var(--text-main);
            margin-bottom: 40px;
            min-height: 80px; /* Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù¾Ø±Ø´ Ø§Ø±ØªÙØ§Ø¹ */
        }

        /* --- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø§Ø³Ø® --- */
        .options-grid {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
            position: relative;
        }

        /* Ø®Ø· Ø§ØªØµØ§Ù„ Ù¾Ø´Øª Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ */
        .options-grid::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 10px;
            right: 10px;
            height: 2px;
            background: #eee;
            z-index: 0;
            transform: translateY(-50%);
        }

        .option-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: var(--card-bg);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            border: 2px solid #eee;
            color: var(--text-light);
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            z-index: 1;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Ø§ÙÚ©Øª ÙÙ†Ø±ÛŒ */
        }

        /* Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø´Ø¯Øª */
        .btn-1 { border-color: #FF6B6B; color: #FF6B6B; }
        .btn-2 { border-color: #FFB86B; color: #FFB86B; }
        .btn-3 { border-color: #eee; color: #aaa; transform: scale(0.8); } /* ÙˆØ³Ø·ÛŒ Ú©ÙˆÚ†Ú©ØªØ± */
        .btn-4 { border-color: #4ECDC4; color: #4ECDC4; }
        .btn-5 { border-color: var(--primary); color: var(--primary); }

        /* Ø­Ø§Ù„Øª Ø§Ú©ØªÛŒÙˆ Ùˆ Ù‡Ø§ÙˆØ± */
        .option-btn:active { transform: scale(0.9); }
        .btn-1:active { background: #FF6B6B; color: white; }
        .btn-5:active { background: var(--primary); color: white; }

        .labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: var(--text-light);
            margin-top: 15px;
            font-weight: 500;
        }

        /* --- ØµÙØ­Ù‡ Ø´Ø±ÙˆØ¹ Ùˆ Ù¾Ø§ÛŒØ§Ù† --- */
        .screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            text-align: center;
            padding: 30px;
            transition: opacity 0.5s;
        }
        
        .start-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--primary);
            text-shadow: 0 5px 15px rgba(30, 95, 116, 0.2);
        }

        .hero-btn {
            background: var(--primary);
            color: white;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            margin-top: 30px;
            box-shadow: 0 10px 20px rgba(30, 95, 116, 0.3);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .hero-btn:active { transform: scale(0.95); }

        /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ */
        .fade-out { opacity: 0; transform: translateY(-10px) scale(0.98); }
        .fade-in { opacity: 1; transform: translateY(0) scale(1); }
        .hidden { display: none !important; }

    </style>
</head>
<body>

    <!-- Ù¾ÛŒØ§Ù… Ø¹Ø¯Ù… Ø¯Ø³ØªØ±Ø³ÛŒ -->
    <div id="access-denied">â›” Ù„Ø·ÙØ§ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù… ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯.</div>

    <!-- ØµÙØ­Ù‡ Ø´Ø±ÙˆØ¹ (Landing) -->
    <div id="start-screen" class="screen">
        <div class="start-icon">âœ¨</div>
        <h1 style="color: var(--primary); margin:0;">Ø®ÙˆØ¯Øª Ø±Ø§ Ø¨Ø¨ÛŒÙ†</h1>
        <p style="color: var(--text-light); margin-top:10px;">ØªØ­Ù„ÛŒÙ„ Ø´Ø®ØµÛŒØª Ø¨Ø§ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ</p>
        <button class="hero-btn" onclick="startQuiz()">Ø´Ø±ÙˆØ¹ ØªØ­Ù„ÛŒÙ„</button>
    </div>

    <!-- ØµÙØ­Ù‡ Ù¾Ø§ÛŒØ§Ù† (Loading/Sending) -->
    <div id="end-screen" class="screen hidden" style="background: var(--card-bg);">
        <div class="start-icon">ğŸ§ </div>
        <h2 style="color: var(--primary);">ØªØ­Ù„ÛŒÙ„ Ú©Ø§Ù…Ù„ Ø´Ø¯</h2>
        <p style="color: var(--text-light);">Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ...</p>
    </div>

    <!-- Ø¨Ø¯Ù†Ù‡ Ø§ØµÙ„ÛŒ Ø³ÙˆØ§Ù„Ø§Øª -->
    <div class="app-container" id="quiz-app">
        <div class="progress-container">
            <div class="progress-bar" id="progress"></div>
        </div>

        <div class="card" id="question-card">
            <div>
                <div class="question-meta">Question <span id="curr-q">1</span> / <span id="total-q">96</span></div>
                <div class="question-text" id="q-text">Loading...</div>
            </div>

            <div>
                <div class="options-grid">
                    <button class="option-btn btn-1" onclick="selectAnswer(1)">1</button>
                    <button class="option-btn btn-2" onclick="selectAnswer(2)">2</button>
                    <button class="option-btn btn-3" onclick="selectAnswer(3)">3</button>
                    <button class="option-btn btn-4" onclick="selectAnswer(4)">4</button>
                    <button class="option-btn btn-5" onclick="selectAnswer(5)">5</button>
                </div>
                <div class="labels">
                    <span style="color:#FF6B6B">Ù…Ø®Ø§Ù„ÙÙ…</span>
                    <span style="color:var(--primary)">Ù…ÙˆØ§ÙÙ‚Ù…</span>
                </div>
            </div>
        </div>
    </div>

<script>
    // 1. ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù…
    const tg = window.Telegram.WebApp;
    tg.expand(); 

    // Ú†Ú© Ú©Ø±Ø¯Ù† Ù…Ø­ÛŒØ· Ø§Ø¬Ø±Ø§
    if (tg.platform === 'unknown' && !window.location.hash.includes('debug')) {
        document.getElementById('access-denied').style.display = 'block';
        document.getElementById('start-screen').style.display = 'none';
    }

    // ===========================================
    // âš ï¸ Ø§ÛŒÙ†Ø¬Ø§ Ù„ÛŒØ³Øª Ú©Ø§Ù…Ù„ Ø³ÙˆØ§Ù„Ø§Øª Ø®ÙˆØ¯Øª Ø±Ùˆ Ú©Ù¾ÛŒ Ú©Ù†! 
    // ===========================================
    const questionsDB = [
            {"key": "q42", "text": "You thrive on new and exciting experiences."},
            {"key": "q93", "text": "You are described as â€œstuck in your ways.â€"},
            {"key": "q88", "text": "You are drawn to the new, novel, and original."},
            {"key": "q19", "text": "You may be viewed as selfish or self-centered."},
            {"key": "q23", "text": "You believe that arriving at a truth is more important than winning an argument."},
            {"key": "q18", "text": "You imagine things that arenâ€™t directly connected to the real world."},
            {"key": "q90", "text": "You become upset when your care for others goes unappreciated."},
            {"key": "q36", "text": "You easily sympathize with othersâ€™ struggles."},
            {"key": "q73", "text": "You have a strong tendency to see things as either good or bad."},
            {"key": "q67", "text": "You consider yourself an organized person and take control of situations before they get out of hand."},
            {"key": "q15", "text": "You dislike change."},
            {"key": "q52", "text": "You may be described as ditzy or scatterbrained."},
            {"key": "q32", "text": "You try to help people to the point where you begin to forget taking care of your own needs."},
            {"key": "q92", "text": "You prefer living in your dreams to living in the real world."},
            {"key": "q31", "text": "You greatly value social harmony and often go out of your way to maintain it."},
            {"key": "q70", "text": "You always try to communicate tactfully with people."},
            {"key": "q81", "text": "You find it difficult to concentrate on a single subject."},
            {"key": "q43", "text": "You follow a consistent routine."},
            {"key": "q84", "text": "You believe your presence is greatly felt in a room."},
            {"key": "q57", "text": "You cannot help but get hung up on small details."},
            {"key": "q2", "text": "You place a lot of value on details and past experiences."},
            {"key": "q20", "text": "You are drawn toward the abstract and often obsess over meanings."},
            {"key": "q58", "text": "You often feel awkward and aimless during leisure time."},
            {"key": "q5", "text": "You easily recognize internal bodily sensations and act to suit your bodyâ€™s needs."},
            {"key": "q41", "text": "You tend to express sympathy only after you empathize with someone."},
            {"key": "q45", "text": "You live in the present, not the past or the future."},
            {"key": "q40", "text": "You work through problems by yourself and detach yourself from other people to arrive at a conclusion."},
            {"key": "q56", "text": "You modify internal logical frameworks to account for new data, and you sometimes find yourself re-evaluating them when new data is incompatible with it."},
            {"key": "q26", "text": "You are unnerved by uncertainty and the unknown."},
            {"key": "q95", "text": "You explore things in depth for purely for the sake of exploring them in depth."},
            {"key": "q91", "text": "You see the world as a bundle of possibilities waiting to be explored."},
            {"key": "q51", "text": "You feel as though your insights often go misunderstood."},
            {"key": "q64", "text": "You frequently have hunches or insights about the future that turn out to be correct."},
            {"key": "q53", "text": "Generally, you would prefer a solution be thorough before putting it into action (at the cost of time)."},
            {"key": "q12", "text": "You live in the â€œhere and now.â€"},
            {"key": "q17", "text": "You greatly value tradition and duty."},
            {"key": "q55", "text": "You have a strict internal moral code that comes from within regardless of any external standards."},
            {"key": "q16", "text": "You see so many possibilities that you have trouble committing to a single one."},
            {"key": "q29", "text": "You become stubborn and resolute in the face of opposition when it comes to your personal beliefs."},
            {"key": "q75", "text": "You have trouble communicating with those who do not think like you."},
            {"key": "q78", "text": "You feel as though you are one of the only truly nice people left in this world."},
            {"key": "q66", "text": "You often use analogies and similes to communicate new ideas."},
            {"key": "q89", "text": "You generally work through problems with others and involve yourself with other people to arrive at a conclusion."},
            {"key": "q63", "text": "You stay true to yourself."},
            {"key": "q79", "text": "You have trouble communicating your ideas with people."},
            {"key": "q38", "text": "You express yourself honestly and authentically."},
            {"key": "q9", "text": "You are blunt and straight-to-the-point in communication."},
            {"key": "q48", "text": "You are an excellent problem solver and have an incredible ability to analyze things in depth."},
            {"key": "q54", "text": "You constantly set yourself on goals and objectives."},
            {"key": "q35", "text": "You are extremely objective and â€œtell it as it is.â€"},
            {"key": "q46", "text": "You understand a concept by logically recognizing and drawing patterns between different, already known concepts."},
            {"key": "q47", "text": "You exude charisma and are usually viewed as charming by others."},
            {"key": "q33", "text": "You take on subjects with a burning interest only to drop them once they no longer feel new to you."},
            {"key": "q10", "text": "You rely only on past experiences to guide yourself through the present."},
            {"key": "q1", "text": "You are fiercely individualistic and pride yourself on your uniqueness."},
            {"key": "q72", "text": "You have an excellent sense of direction and instantly know your way around a new place."},
            {"key": "q80", "text": "You are attracted to symbolism, mysticism and the unknown."},
            {"key": "q82", "text": "You value truth and logic more than anything else."},
            {"key": "q85", "text": "You absorb information from the outside world without additional processing."},
            {"key": "q94", "text": "You are hesitant to strictly conform to social roles."},
            {"key": "q28", "text": "You are often the first to react to a question."},
            {"key": "q44", "text": "You are a brainstormer: you offer a multitude of different ideas in a given situation."},
            {"key": "q11", "text": "You have a tendency to go off-topic in conversation."},
            {"key": "q69", "text": "You may be viewed as whiny and/or depressive."},
            {"key": "q62", "text": "You may be viewed as â€œmeddlingâ€ or â€œcontrollingâ€ to others."},
            {"key": "q68", "text": "You may be seen as reckless and unknowingly hurt those around you."},
            {"key": "q77", "text": "You would rather sugarcoat a problem than upset someone."},
            {"key": "q83", "text": "You have been consistently logical throughout your life."},
            {"key": "q34", "text": "You would question anything."},
            {"key": "q13", "text": "You can easily think of something random to say."},
            {"key": "q37", "text": "You have an uncanny ability of recognizing othersâ€™ needs."},
            {"key": "q50", "text": "You like to organize things for pleasure."},
            {"key": "q30", "text": "You place a great amount of trust in the mysterious and unconscious world."},
            {"key": "q60", "text": "You are a risk-taker."},
            {"key": "q6", "text": "You find yourself agreeing with those who claim that the ends justify the means."},
            {"key": "q87", "text": "You would do whatever it takes to win a debate."},
            {"key": "q49", "text": "You start many different projects, but you finish few."},
            {"key": "q39", "text": "You sometimes fail to adapt to new data because it is not consistent with your personal understanding of an idea."},
            {"key": "q8", "text": "You feel a strong sense of unity when communicating with others in a group."},
            {"key": "q25", "text": "You trust hard facts and data more than anything else."},
            {"key": "q96", "text": "You are aware of your surroundings and arenâ€™t likely to miss something right in front of you."},
            {"key": "q59", "text": "You often use metaphors to communicate new ideas."},
            {"key": "q74", "text": "You streamline existing systems for the sake of efficiency and productivity."},
            {"key": "q61", "text": "You are able to manipulate conversations by reading othersâ€™ body language."},
            {"key": "q65", "text": "You see the big picture in a sea of details."},
            {"key": "q22", "text": "You often arrive at conclusions that seem to come out of nowhere; you relate to â€œrealizingâ€ answers."},
            {"key": "q14", "text": "You relate present experiences back to past experiences."},
            {"key": "q4", "text": "You have an eye for aesthetics and â€œenjoy the finer things in life.â€"},
            {"key": "q27", "text": "You rely on external sources to support your argument."},
            {"key": "q3", "text": "You are skilled at recognizing whether the details in front of you match what you are used to."},
            {"key": "q21", "text": "You come up with internal logical frameworks, theories, and systems to describe the world around you."},
            {"key": "q86", "text": "You value inclusion and try your best to involve everyone in a group."},
            {"key": "q71", "text": "Fake people bother you."},
            {"key": "q24", "text": "You may be viewed as â€œfakeâ€ or â€œmanipulativeâ€ to others."},
            {"key": "q76", "text": "You consider yourself a practical and realistic person, free from imagination."},
            {"key": "q7", "text": "You â€œjust knowâ€ things without being able to consciously put them into words."}
    ];

    let currentIndex = 0;
    let userAnswers = {};

    function startQuiz() {
        // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù…Ø­Ùˆ Ø´Ø¯Ù† ØµÙØ­Ù‡ Ø´Ø±ÙˆØ¹
        const startScreen = document.getElementById('start-screen');
        startScreen.style.opacity = '0';
        setTimeout(() => {
            startScreen.classList.add('hidden');
            document.getElementById('quiz-app').style.display = 'flex';
            loadQuestion();
        }, 500);
    }

    function loadQuestion() {
        const qText = document.getElementById('q-text');
        const card = document.getElementById('question-card');
        
        // Ø±ÛŒØ³Øª Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
        card.classList.remove('fade-out');
        card.classList.add('fade-in');

        // Ù„ÙˆØ¯ Ø¯ÛŒØªØ§
        const q = questionsDB[currentIndex];
        document.getElementById('curr-q').innerText = currentIndex + 1;
        document.getElementById('total-q').innerText = questionsDB.length;
        qText.innerText = q.text;

        // Ø¢Ù¾Ø¯ÛŒØª Ù¾Ø±ÙˆÚ¯Ø±Ø³ Ø¨Ø§Ø±
        const percent = ((currentIndex) / questionsDB.length) * 100;
        document.getElementById('progress').style.width = percent + '%';
    }

    function selectAnswer(score) {
        // ÙˆÛŒØ¨Ø±Ù‡ ØªÙ„Ú¯Ø±Ø§Ù…
        if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');

        const card = document.getElementById('question-card');
        
        // Ø°Ø®ÛŒØ±Ù‡ Ø¬ÙˆØ§Ø¨
        userAnswers[questionsDB[currentIndex].key] = score;

        // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø®Ø±ÙˆØ¬ Ú©Ø§Ø±Øª
        card.classList.remove('fade-in');
        card.classList.add('fade-out');

        setTimeout(() => {
            currentIndex++;
            if (currentIndex < questionsDB.length) {
                loadQuestion();
            } else {
                finishQuiz();
            }
        }, 250); // ØµØ¨Ø± Ù…ÛŒÚ©Ù†ÛŒÙ… ØªØ§ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† ØªÙ…ÙˆÙ… Ø´Ù‡
    }

    function finishQuiz() {
        document.getElementById('quiz-app').style.display = 'none';
        const endScreen = document.getElementById('end-screen');
        endScreen.classList.remove('hidden');
        
        // ØªØºÛŒÛŒØ± Ø¯Ú©Ù…Ù‡ Ø§ØµÙ„ÛŒ ØªÙ„Ú¯Ø±Ø§Ù…
        tg.MainButton.text = "Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù†ØªÛŒØ¬Ù‡";
        tg.MainButton.show();
        
        // Ø§Ø±Ø³Ø§Ù„ Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ø² Û± Ø«Ø§Ù†ÛŒÙ‡ (ÛŒØ§ Ø¨Ø§ Ø¯Ú©Ù…Ù‡)
        setTimeout(() => {
            tg.sendData(JSON.stringify(userAnswers));
        }, 1500);
    }

</script>
</body>
</html>
